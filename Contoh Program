<?php
// ======= FUNGSI 1: Koneksi Database =======
function koneksi_db() {
    $conn = mysqli_connect("localhost", "root", "", "db_kampus");
    if (!$conn) {
        die("Koneksi gagal: " . mysqli_connect_error());
    }
    return $conn;
}

// ======= FUNGSI 2: Simpan Absen =======
function simpan_absen($nim, $tanggal, $status) {
    $conn = koneksi_db();
    $query = "INSERT INTO absen (nim, tanggal, status) VALUES ('$nim', '$tanggal', '$status')";
    if (mysqli_query($conn, $query)) {
        echo "✅ Data absensi berhasil disimpan.<br>";
    } else {
        echo "❌ Gagal menyimpan data: " . mysqli_error($conn);
    }
    mysqli_close($conn);
}

// ======= FUNGSI 3: Tampil Absen =======
function tampil_absen() {
    $conn = koneksi_db();
    $result = mysqli_query($conn, "SELECT * FROM absen ORDER BY tanggal DESC");
    
    echo "<h3>Daftar Kehadiran Mahasiswa</h3>";
    echo "<table border='1' cellpadding='5'>";
    echo "<tr><th>NIM</th><th>Tanggal</th><th>Status</th></tr>";
    
    while ($row = mysqli_fetch_assoc($result)) {
        echo "<tr>
                <td>{$row['nim']}</td>
                <td>{$row['tanggal']}</td>
                <td>{$row['status']}</td>
              </tr>";
    }
    echo "</table>";
    mysqli_close($conn);
}

// ======= PROGRAM UTAMA =======
$nim = "12345";
$tanggal = date("Y-m-d");
$status = "Hadir";

simpan_absen($nim, $tanggal, $status);
tampil_absen();
?>
